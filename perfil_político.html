 <!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Rastreamento de Perfil Político</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background-color: #f2f2f2;
      max-width: 600px;
      margin: auto;
    }
    input[type="text"] {
      width: 100%;
      padding: 12px;
      margin-top: 10px;
    }
    button {
      padding: 12px;
      margin-top: 10px;
      background-color: #0066cc;
      color: white;
      border: none;
      cursor: pointer;
      width: 100%;
    }
    button:hover {
      background-color: #004c99;
    }
    #resultado {
      margin-top: 20px;
      white-space: pre-wrap;
      background-color: white;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 0 8px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>
  <h2>Rastreamento de Perfil Político</h2>
  <label for="nome">Nome do Candidato:</label>
  <input type="text" id="nome" placeholder="Digite o nome completo">
  <button onclick="enviarNome()">Buscar Perfil</button>
  <div id="resultado">Resultado aparecerá aqui...</div>

  <!-- Biblioteca para exportar Excel -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

  <script>
    async function enviarNome() {
      const nome = document.getElementById('nome').value;
      const resultadoDiv = document.getElementById('resultado');
      resultadoDiv.textContent = "Buscando dados para: " + nome + " ...";

      try {
        const response = await fetch("https://api.openai.com/v1/chat/completions", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": "Bearer SUA_CHAVE_OPENAI"
          },
          body: JSON.stringify({
            model: "gpt-4",
            messages: [{
              role: "user",
              content: `Pesquise onde o candidato "${nome}" possui perfil online: Instagram, Facebook, TikTok, LinkedIn etc. Busque também por notícias e processos judiciais. Organize os resultados em colunas: Plataforma/Notícia, Link, Tipo, Observações.`
            }]
          })
        });

        const data = await response.json();
        const resultado = data.choices[0].message.content;
        resultadoDiv.textContent = resultado;

        // Converter texto para planilha
        const linhas = resultado.split('\n').filter(l => l.includes('|'));
        const dados = linhas.map(linha => {
          const partes = linha.split('|').map(p => p.trim());
          return {
            Plataforma: partes[0] || '',
            Link: partes[1] || '',
            Tipo: partes[2] || '',
            Observações: partes[3] || ''
          };
        });

        const wb = XLSX.utils.book_new();
        const ws = XLSX.utils.json_to_sheet(dados);
        XLSX.utils.book_append_sheet(wb, ws, "Perfil Político");
        XLSX.writeFile(wb, `${nome.replace(/\s+/g, "_")}_perfil.xlsx`);
      } catch (erro) {
        resultadoDiv.textContent = "Erro ao buscar dados. Verifique sua conexão ou chave da API.";
        console.error(erro);
      }
    }
  </script>
</body>
</html>
